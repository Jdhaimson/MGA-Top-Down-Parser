This port from the OCaml parser contributed by Victor Chou --
a first pass through the basic parsing functions.
